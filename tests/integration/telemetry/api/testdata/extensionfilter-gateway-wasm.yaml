apiVersion: extensions.istio.io/v1alpha1
kind: ExtensionFilter
metadata:
  name: {{ .ExtensionFilterName }}
  {{- if .FilterVersion }}
  annotations:
    filterVersion: {{ .FilterVersion }}
  {{- end }}
spec:
  phase: STATS
  targetRef:
    kind: Gateway
    group: gateway.networking.k8s.io
    name: {{ .TargetGatewayName}}
  wasm:
    {{- if .TestWasmModuleURL }}
    url: {{ .TestWasmModuleURL }}
    {{- end }}
    imagePullSecret: reg-cred
    {{- if .ImagePullPolicy }}
    imagePullPolicy: {{ .ImagePullPolicy }}
    {{- end }}
